<!DOCTYPE html>
<html>
<body>
<h3>Xin chào {{user.name}}</h3>
<a href="/logout">Logout</a>
<hr>

<input id="email" placeholder="merchant@gmail.com">
<button onclick="search()">Search</button>
<ul id="list"></ul>

<script>
async function search() {
  const f = new FormData()
  f.append("merchant_email", email.value)
  const r = await fetch("/search", {method:"POST", body:f})
  const d = await r.json()
  list.innerHTML=""
  d.forEach(m=>{
    list.innerHTML+=`<li>${m.subject}
    <button onclick="resend('${m.id}')">Resend</button></li>`
  })
}
async function resend(id){
  const f=new FormData()
  f.append("email_id",id)
  f.append("merchant_email",email.value)
  await fetch("/resend",{method:"POST",body:f})
  alert("Đã gửi lại")
}
</script>
</body>
</html>